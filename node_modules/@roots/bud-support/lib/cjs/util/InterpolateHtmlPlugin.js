'use strict'
Object.defineProperty(exports, '__esModule', {value: true})
const tslib_1 = require('tslib')
const escape_string_regexp_1 = tslib_1.__importDefault(
  require('escape-string-regexp'),
)
class InterpolateHtmlPlugin {
  constructor(htmlWebpackPlugin, replacements) {
    this.name = 'interpolate-html-plugin'
    this.htmlWebpackPlugin = htmlWebpackPlugin
    this.replacements = replacements
  }
  apply(compiler) {
    compiler.hooks.compilation.tap(
      'InterpolateHtmlPlugin',
      compilation => {
        this.htmlWebpackPlugin
          .getHooks(compilation)
          .afterTemplateExecution.tap(
            'InterpolateHtmlPlugin',
            data => {
              Object.entries(this.replacements).forEach(
                ([key, value]) => {
                  data.html = data.html.replace(
                    new RegExp(
                      `%${escape_string_regexp_1.default(key)}%`,
                      'g',
                    ),
                    value,
                  )
                },
              )
            },
          )
      },
    )
  }
}
exports.default = InterpolateHtmlPlugin
//# sourceMappingURL=InterpolateHtmlPlugin.js.map
