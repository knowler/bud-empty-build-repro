'use strict'
Object.defineProperty(exports, '__esModule', {value: true})
exports.useStyle = void 0
const tslib_1 = require('tslib')
const react_1 = tslib_1.__importDefault(require('react'))
const ink_use_stdout_dimensions_1 = tslib_1.__importDefault(
  require('ink-use-stdout-dimensions'),
)
const index_1 = require('../themes/index')
/**
 * Use style.
 */
const useStyle = (initialData = index_1.defaultTheme) => {
  /**
   * Theme values
   */
  const [theme, setTheme] = react_1.default.useState(initialData)
  /**
   * Width and height of terminal viewport.
   */
  const [width, height] = ink_use_stdout_dimensions_1.default()
  /**
   * Active screen size
   */
  const [screen, setScreen] = react_1.default.useState()
  /**
   * Width of one column.
   */
  const [unit, setUnit] = react_1.default.useState(null)
  /**
   * Width and height of application.
   */
  const [bounds, setBounds] = react_1.default.useState({
    width,
    height,
  })
  /**
   * Set application based on viewport size.
   */
  react_1.default.useEffect(() => {
    setBounds({
      width: width > theme.maxWidth ? theme.maxWidth : width,
      height:
        height > theme.maxHeight ? theme.maxHeight : height,
    })
  }, [width, height])
  /**
   * Set unit to be the total application width available
   * divided by the column count
   */
  react_1.default.useEffect(() => {
    setUnit(bounds.width / theme.columns)
  }, [bounds])
  /**
   * Determine which screen size is currently active.
   */
  react_1.default.useEffect(() => {
    theme.screens.forEach(([lower, upper], iteration) => {
      bounds.width > lower &&
        bounds.width < upper &&
        setScreen(iteration)
    })
  }, [bounds, theme])
  /**
   * Col
   * Function that returns the width for x columns
   */
  const col = count => {
    return unit * count
  }
  /**
   * Ctx
   *
   * Function that takes an array of possible display values
   * and returns the one that matches the current screen size.
   */
  const ctx = screens => {
    var _a
    const value =
      (_a = screens[screen]) !== null && _a !== void 0
        ? _a
        : screens[screens.length - 1]
    return typeof value == 'number' ? Math.floor(value) : value
  }
  /**
   * Set colors
   *
   * Merges colors onto theme.
   */
  const setColors = colors => {
    setTheme(
      Object.assign(Object.assign({}, theme), {
        colors: Object.assign(
          Object.assign({}, theme.colors),
          colors,
        ),
      }),
    )
  }
  /**
   * Set screens
   *
   * Merges colors onto theme.
   */
  const setScreens = screens => {
    setTheme(
      Object.assign(Object.assign({}, theme), {
        screens: [...theme.screens, ...screens],
      }),
    )
  }
  return Object.assign(
    Object.assign({col, bounds, screen}, theme),
    {setColors, setScreens, ctx},
  )
}
exports.useStyle = useStyle
//# sourceMappingURL=index.js.map
